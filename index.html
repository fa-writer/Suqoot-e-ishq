<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>کتاب من</title>
<link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;600&display=swap" rel="stylesheet">
<style>
:root {
  --bg-light: #fdf6e3;
  --bg-dark: #2e2e2e;
  --text-light: #333;
  --text-dark: #f5f5f5;
  --accent: #b58863;
  --card-bg-light: rgba(255,248,240,0.95);
  --card-bg-dark: rgba(62,62,62,0.95);
}
* {margin:0;padding:0;box-sizing:border-box;font-family:'Vazirmatn',sans-serif;}
body {
  background-size: cover;
  color:var(--text-light);
  transition:all 0.4s;
  overflow-x:hidden;
  background: url('imge/bgr2.jpg') no-repeat center;
}
  @font-face {
  font-family: "MyFont"; /* اسم دلخواه برای فونت */
  src: url("font/font3.otf") format("opentype");
  font-weight: normal;
  font-style: normal;
}
/* Splash */
/* Splash */
#splash {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: var(--bg-light) url('imge/bgr.jpg') no-repeat center center/cover; /* تصویر پس‌زمینه */
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  transition: opacity 0.5s;
  color: #b5522e;
  text-align: center;
}

#splashLogo {
  width: 150px;  /* اندازه دلخواه لوگو */
  margin-bottom: 1rem;
}
  /*dark mod css*/
  /* حالت دارک برای صفحه‌خوان */
body.dark #reader {
  background: var(--bg-dark);
  color: var(--text-dark);
}

body.dark #reader .page-container {
  background: var(--bg-dark);
}

body.dark #reader .page {
  color: var(--text-dark);
}

body.dark #reader .reader-header {
  background: #444;   /* رنگ تیره هدر */
  color: #fff;
}

body.dark #reader .reader-bottom {
  background: rgba(255,255,255,0.05);
  color: var(--text-dark);
}

#splash.hidden {
  opacity: 0;
  pointer-events: none;
}
  #splash h1{font-family: "MyFont"; font-size:3rem}
  #themeToggle { transition: transform 0.3s; }
#themeToggle:hover { transform: scale(1.2); }
.chapter-card:hover{
  transform: translateY(-5px) scale(1.03);
  box-shadow: 0 8px 20px rgba(0,0,0,0.25);
}
  button {
  background: var(--accent);
  color: #fff;
  padding: 0.4rem 0.8rem;
  border-radius: 8px;
  box-shadow: 0 3px 6px rgba(0,0,0,0.2);
  transition: all 0.3s ease;
}
button:hover {
  transform: scale(1.05);
  box-shadow: 0 6px 12px rgba(0,0,0,0.25);
}
  body.dark {
  background: var(--bg-dark) url('imge/bgr-dark.jpg') no-repeat center; 
  color: var(--text-dark);
}

body.dark .chapter-card {
  background: var(--card-bg-dark);
  color: var(--text-dark);
}

body.dark header {
  background: linear-gradient(90deg, #3e3e3e, #1e1e1e);
  color: var(--text-dark);
}

body.dark .sidebar {
  background: var(--card-bg-dark);
  color: var(--text-dark);
}
  /* زیرمنوی فصول در دارک مود */
body.dark .submenu {
  background: var(--bg-dark);
  color: var(--text-dark);
}

body.dark .submenu li {
  color: var(--text-dark);
}

body.dark .submenu li:hover {
  color: var(--accent);
}

body.dark .reader-header {
  background: #444;
  color: #fff;
}
  body.dark {
  background: url('imge/bgr1.jpg') no-repeat;
  background-size: cover;
}
/* Header */
header{display:flex;background:#fff;justify-content:space-between;align-items:center;padding:0.8rem 1rem;color:#ff;position:sticky;top:0;z-index:10;}
header h1{font-size:2.2rem; color: #b5522e;font-family: "MyFont";}
header .top-buttons button {
  background: rgba(255,255,255,0.2);
  color: #ff;
  padding: 0.3rem 0.6rem;
  border-radius: 6px;
  transition: 0.3s;
}
header .top-buttons button:hover {
  background: rgba(255,255,255,0.5);
  transform: scale(1.1);
}
  .header {
  display: flex;
  align-items: center;
  gap: 10px;        /* فاصله بین لوگو و اسم کتاب */
  padding: 10px 20px;
  border-bottom: 2px solid #333;
}

.logo {
  width: 40px;      /* اندازه لوگو */
  height: 40px;
  object-fit: contain;
  margin-left: 6px;
}
  body.dark .header {
  background: #222;
  border-bottom: 1px solid #444;
}
  /* دکمه‌های کنترل فونت در دارک مود */
body.dark #fontDecrease,
body.dark #fontIncrease {
  background: rgba(100,100,100,0.8);
  color: #fff;
}

body.dark #fontDecrease:hover,
body.dark #fontIncrease:hover {
  background: rgba(150,150,150,1);
}

/* دکمه‌های قبلی / بعدی در دارک مود */
body.dark .reader-bottom button {
  background: #555;
  color: #fff;
}

body.dark .reader-bottom button:hover {
  background: #777;
  transform: scale(1.05);
}

/* Sidebar */
.sidebar{position:fixed;top:0;right:0;width:250px;height:100%;background:var(--card-bg-light);padding:2rem 1rem;box-shadow:-3px 0 8px rgba(0,0,0,0.2);transition:transform 0.3s;z-index:20;}
.sidebar.hidden{transform:translateX(100%);}
.sidebar ul{list-style:none;}
.sidebar li{padding:0.5rem 0;cursor:pointer;transition:0.2s;}
.sidebar li:hover{color:var(--accent);}
.overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.3);z-index:15;display:none;}
.overlay.active{display:block;}
.sidebar ul { list-style:none; padding:0; }
.submenu {
  padding-right: 1rem;
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.4s ease;
}
.submenu li {
  padding: 0.4rem 0;
  font-size: 0.95rem;
  color: #455;
}
.submenu li:hover { color: var(--accent); }

/* کلاس برای باز کردن زیرمنو */
.submenu.show {
  max-height: 450px; /* ارتفاع کافی برای نشان دادن کل فصل‌ها */
}
/* Chapters grid */
main{padding:1rem;display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1rem;position:relative;z-index:1;}
.chapter-card{background:rgba(23,42,17,110);padding:0.3rem;border-radius:10px;box-shadow:0 3px 8px rgba(0,0,0,0.1);transition:0.3s;cursor:pointer;max-width:500px;height:60px; border: 2px #333;}
.chapter-card:hover{transform:translateY(-5px);box-shadow:0 10px 15px rgba(0,0,0,0.6);}
.chapter-card h3{margin-bottom:0rem;font-size:1.1rem;}

/* Reader */
#reader{position:fixed;top:0;right:0;width:100%;height:100%;background:var(--card-bg-light);color:inherit;display:none;flex-direction:column;z-index:10;overflow:hidden;}
.reader-header{padding:1rem;background:var(--accent);color:#fff;display:flex;justify-content:center;align-items:center;position:relative;}
.reader-header h2{font-size:1.3rem;}
.reader-header button{position:absolute;left:1rem;top:50%;transform:translateY(-50%);font-size:1.1rem;}

  /* دکمه کاهش فونت در گوشه بالا چپ */
/* دکمه کاهش فونت در گوشه بالا چپ */
#fontDecrease {
  position: fixed;
  top: 70px; /* کمی پایین‌تر از هدر */
  left: 0.8rem;
  background: rgba(181,136,99,0.8);
  color: #fff;
  padding: 0.25rem 0.5rem; /* کوچکتر شد */
  font-size: 0.7rem;       /* کوچکتر شد */
  border-radius: 6px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.2);
  z-index: 100;
  transition: all 0.3s;
}
#fontDecrease:hover { transform: scale(1.1); background: rgba(181,136,99,1); }

/* دکمه افزایش فونت در گوشه بالا راست */
#fontIncrease {
  position: fixed;
  top: 70px;
  right: 0.8rem;
  background: rgba(181,136,99,0.8);
  color: #fff;
  padding: 0.25rem 0.5rem; /* کوچکتر شد */
  font-size: 0.7rem;       /* کوچکتر شد */
  border-radius: 6px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.2);
  z-index: 100;
  transition: all 0.3s;
}
#fontIncrease:hover { transform: scale(1.1); background: rgba(181,136,99,1); }
  #fontControls button {
  background: rgba(181,136,99,0.9);
  padding: 0.3rem 0.6rem;
  border-radius: 6px;
}
#fontControls button:hover {
  background: rgba(181,136,99,1);
  transform: scale(1.1);
}
/* Page container */
.page-container{flex:1;display:block;overflow:hidden;position:relative;padding:100px 2rem 2rem 2rem;}
.page{
  margin: 40px 80px 40px 20px;
  position:absolute;
  overflow-y:auto;
  top:0;
  left:0;
  width:100%;
  height:100%;
  padding: 1px 50px 90px 10px;
  line-height:1.9;
  transition:transform 0.3s;
  white-space:pre-wrap;
  font-size: clamp(13px, 2.5vw, 18px);
}
  .page p {
  all: unset;              /* تمام استایل پیش‌فرض مرورگر حذف می‌شود */
  display: block;          /* مثل پاراگراف رفتار کند */
  margin: 0;               /* هیچ فاصله‌ی بالا/پایین نداشته باشد */
  padding: 0;
  line-height: 1.8;        /* فاصله بین خطوط متن */
}

.page p + p {
  margin-top: 6px;         /* فقط وقتی پاراگراف پشت سر هم بود ۶px فاصله بده */
}

/* Bottom bar */
.reader-bottom{
  position:absolute;
  bottom:0;
  width:100%;
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:0.5rem 1rem;
  background:rgba(0,0,0,0.05);
}
.reader-bottom .page-indicator{
  position:absolute;
  left:50%;
  transform:translateX(-50%);
  font-size:0.9rem;
}
  .reader-bottom button {
  padding: 0.4rem 0.8rem;
  border-radius: 8px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
  transition: all 0.3s;
}
.reader-bottom button:hover {
  background: #a06b4d;
  transform: scale(1.05);
}
  #chapters {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
  padding: 30px;
}

.chapter-card {
  background: #fff8e1; /* رنگ کاغذی */
  border: 2px solid #d6c6a8;
  padding: 8px;
  border-radius: 12px;
  text-align: center;
  cursor: pointer;
  position: relative;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  box-shadow: 0 10px 15px rgba(0,0,0,0.2);

  /* افکت لبه‌های نامنظم (کاغذ بریده شده) */
  clip-path: polygon(
    0% 10%, 10% 0%, 90% 0%, 100% 10%,
    100% 90%, 90% 100%, 10% 100%, 0% 90%
  );
}

.chapter-card:hover {
  transform: translateY(-6px) rotate(-1deg);
  box-shadow: 0 8px 20px rgba(0,0,0,0.3);
  background: #fffdf6;
}

.chapter-card h3 {
  margin: 0;
  font-size: 19px;
  font-family: "Vazirmatn", sans-serif;
  color: #53e1b;
}

.chapter-card p {
  margin-top: 1px;
  font-size: 15px;
  color: #33;
}
</style>
</head>
<body>
<div id="splash">
  <img src="imge/log2.png" alt="لوگو کتاب" id="splashLogo">
  <h1>ترس از سقوط عشق</h1>
</div>

<header class="header">
  <img src="imge/Log2.png" alt="لوگو" class="logo">
<h1>ترس از سقوط عشق</h1>
<div class="top-buttons">
<button id="themeToggle">🌙</button>
<button id="menuToggle">☰</button>
</div>
</header>

<div class="sidebar hidden" id="sidebar">
  <h2>فهرست</h2>
  <ul>
    <li id="menuChapters">فصول ▸</li>
    <ul id="submenuChapters" class="submenu hidden">
      <li onclick="openChapter(0)">فصل اول</li>
      <li onclick="openChapter(1)">فصل دوم</li>
      <li onclick="openChapter(2)">فصل سوم</li>
    </ul>
    <li onclick="showAbout('book')">درباره کتاب</li>
    <li onclick="showAbout('author')">درباره نویسنده</li>
    <li onclick="toggleTheme()">تغییر تم</li>
  </ul>
</div>
<div class="overlay" id="overlay"></div>

<main id="chapters">
<div class="chapter-card" onclick="openChapter(0)"><h3>فصل اول</h3><p>شروع یک ماجرا</p></div>
<div class="chapter-card" onclick="openChapter(1)"><h3>فصل دوم</h3><p>دو سیلی عاشقانه</p></div>
<div class="chapter-card" onclick="openChapter(2)"><h3>فصل سوم</h3><p>آغاز یک خواب طولانی</p></div>
</main>

<div id="reader">
<div class="reader-header">
<h2 id="readerTitle">فصل اول</h2>
<button onclick="closeReader()">✖</button>
</div>
<div id="fontControls">
<button id="fontDecrease" onclick="changeFontSize(-1)">A-</button>
<button id="fontIncrease" onclick="changeFontSize(1)">A+</button>
</div>
<div class="page-container" id="pageContainer"></div>
<div class="reader-bottom">
<button class="nav-left" onclick="prevPage()">⬅ قبلی</button>
<div class="page-indicator" id="pageIndicator">صفحه 1 / N</div>
<button class="nav-right" onclick="nextPage()">بعدی ➡</button>
</div>
</div>

<script>
// Splash
window.addEventListener('load',()=>{
  const splash=document.getElementById('splash');
  setTimeout(()=>{
    splash.classList.add('hidden');
  },1500);
});

// Theme
function setTheme(theme){document.body.classList.toggle('dark',theme==='dark');localStorage.setItem('theme',theme);}
function toggleTheme(){setTheme(document.body.classList.contains('dark')?'light':'dark');}
setTheme(localStorage.getItem('theme')||'light');
// Theme toggle
const themeButton = document.getElementById('themeToggle');

themeButton.addEventListener('click', () => {
  const isDark = document.body.classList.contains('dark');
  document.body.classList.toggle('dark', !isDark);
  localStorage.setItem('theme', !isDark ? 'dark' : 'light');
});
// Sidebar
const sidebar=document.getElementById('sidebar');
const overlay=document.getElementById('overlay');
document.getElementById('menuToggle').addEventListener('click',()=>{sidebar.classList.remove('hidden');overlay.classList.add('active');});
overlay.addEventListener('click',()=>{sidebar.classList.add('hidden');overlay.classList.remove('active');});
const menuChapters = document.getElementById('menuChapters');
const submenuChapters = document.getElementById('submenuChapters');

menuChapters.addEventListener('click', () => {
  submenuChapters.classList.toggle('show');
});
// About
function showAbout(type){alert(type==='book'?'این یک کتاب نمونه است.':'نویسنده: محمد حسین');}

// Chapters
let chapters=[
{title:'فصل اول',pages:[`در یکی از همین کوچه‌ها خانه‌ای بود خاکی و ساده، با دیوارهایی ترک‌خورده که هر لحظه تهدید می‌کردند فرو بریزند، اما هنوز مثل مادری لجوج ایستاده بودند. خانه از بیرون شبیه پیرمردی بود که دندان‌هایش ریخته، اما از درون بوی نان تازه و چای سیاه و حرف‌های آرام مادر خانواده روحش می‌داد. امیر موسوی، جوان بیست‌ساله‌ی این خانه، هر صبح مثل کوه بیدار می‌شد و مثل سنگ در کار سخت دوام می‌آورد. سال‌ها کارگری بدنش را قوام داده بود، دست‌هایش زمخت شده بودند، اما نگاهش هنوز جوان و رویاپرور بود؛ نگاهی که اگر کسی دقیق‌تر می‌شد، می‌فهمید پشت آن رؤیایی خاموش نفس می‌کشد. مادرش، زنی لاغر با دستان پینه‌بسته، سال‌ها بود که با دار قالی هم‌صحبت بود. تار و پودها را مثل نخ‌های سرنوشت به هم می‌بافت. اگر کسی می‌پرسید: «زندگی‌ات چطور می‌گذرد؟» فقط لبخند می‌زد و می‌گفت: «گره به گره.» و زندگی‌اش واقعاً همین بود: گره‌به‌گره، اما رنگ‌دار.<br>زهرا، خواهر شانزده‌ساله‌ی امیر، دختری آرام و خاموش بود که بیشتر شبیه مادری کوچک رفتار می‌کرد. همیشه کنار مادر می‌نشست، قالی می‌بافت و کمتر حرف می‌زد. خواهر کوچک‌ترشان، حسینه، ده‌ساله بود؛ پر از انرژی و بازیگوشی. اگر گربه‌ای از کنار دیوار می‌گذشت، حسینه می‌دوید دنبالش و می‌گفت: «اینجا ننشین، خاکی می‌شی!»`, `در یکی از همین کوچه‌ها خانه‌ای بود خاکی و ساده، با دیوارهایی ترک‌خورده که هر لحظه تهدید می‌کردند فرو بریزند، اما هنوز مثل مادری لجوج ایستاده بودند. خانه از بیرون شبیه پیرمردی بود که دندان‌هایش ریخته، اما از درون بوی نان تازه و چای سیاه و حرف‌های آرام مادر خانواده روحش می‌داد. امیر موسوی، جوان بیست‌ساله‌ی این خانه، هر صبح مثل کوه بیدار می‌شد و مثل سنگ در کار سخت دوام می‌آورد. سال‌ها کارگری بدنش را قوام داده بود، دست‌هایش زمخت شده بودند، اما نگاهش هنوز جوان و رویاپرور بود؛ نگاهی که اگر کسی دقیق‌تر می‌شد، می‌فهمید پشت آن رؤیایی خاموش نفس می‌کشد. مادرش، زنی لاغر با دستان پینه‌بسته، سال‌ها بود که با دار قالی هم‌صحبت بود. تار و پودها را مثل نخ‌های سرنوشت به هم می‌بافت. اگر کسی می‌پرسید: «زندگی‌ات چطور می‌گذرد؟» فقط لبخند می‌زد و می‌گفت: «گره به گره.» و زندگی‌اش واقعاً همین بود: گره‌به‌گره، اما رنگ‌دار.<br>زهرا، خواهر شانزده‌ساله‌ی امیر، دختری آرام و خاموش بود که بیشتر شبیه مادری کوچک رفتار می‌کرد. همیشه کنار مادر می‌نشست، قالی می‌بافت و کمتر حرف می‌زد. خواهر کوچک‌ترشان، حسینه، ده‌ساله بود؛ پر از انرژی و بازیگوشی. اگر گربه‌ای از کنار دیوار می‌گذشت، حسینه می‌دوید دنبالش و می‌گفت: «اینجا ننشین، خاکی می‌شی!»`]},  
{title:'فصل دوم',pages:[`روز دوم، همه‌چیز فرق داشت.`,`حرف‌ها میان اد.`]},  
{title:'فصل سوم',pages:[`آن شب، خواب در چشم‌های همه سنگینی کرد.` , `صبحی که از راه رسید، چیزهایی در بطن شهر تغییر کرده بود.`]}  
];  

// نمایش صفحه
function renderPage(content, container) {
  container.innerHTML = content
    .split("\n\n") // دو خط خالی = پاراگراف جدید
    .map(para => `<div class="para">${para.trim()}</div>`)
    .join("");
}

// وقتی صفحه نمایش داده میشه
function renderPage(content, container) {
  container.innerHTML = content
    .split("\n\n") // دو خط خالی = پاراگراف جدید
    .map(para => `<p>${para.trim()}</p>`)
    .join("");
}

let currentChapter=0, currentPage=0, fontSize=10;
const container=document.getElementById('pageContainer');

function openChapter(i){currentChapter=i;currentPage=0;fontSize=18;setupPages();document.getElementById('reader').style.display='flex';sidebar.classList.add('hidden');overlay.classList.remove('active');}
function closeReader(){document.getElementById('reader').style.display='none';}

function setupPages(){
  container.innerHTML='';
  chapters[currentChapter].pages.forEach((p,i)=>{
    const div=document.createElement('div');
    div.className='page';
    div.innerHTML = p;
    div.style.fontSize=fontSize+'px';
    div.style.transform=`translateX(${i*100}%)`;
    container.appendChild(div);
  });
  updateReader();
}

function updateReader(){
  const pages = container.children;
  for(let i = 0; i < pages.length; i++){
    pages[i].style.transition = 'transform 0.3s';
    pages[i].style.transform = `translateX(${(currentPage - i) * 100}%)`; // معکوس جهت
  }
  document.getElementById('readerTitle').textContent = chapters[currentChapter].title;
  document.getElementById('pageIndicator').textContent = `صفحه ${currentPage+1} / ${chapters[currentChapter].pages.length}`;
}

function nextPage(){if(currentPage<chapters[currentChapter].pages.length-1){currentPage++;updateReader();}}
function prevPage(){if(currentPage>0){currentPage--;updateReader();}}
function changeFontSize(d){fontSize=Math.max(12,Math.min(30,fontSize+d));const pages=container.children;for(let i=0;i<pages.length;i++){pages[i].style.fontSize=fontSize+'px';}}

// Swipe اصلاح شده
// Swipe RTL اصلاح شده
let touchStartX = 0;
container.addEventListener('touchstart', e => {
  touchStartX = e.touches[0].clientX;
});
container.addEventListener('touchend', e => {
  let diff = e.changedTouches[0].clientX - touchStartX;
  if(diff > 50) nextPage();    // کشیدن به راست -> صفحه بعد
  else if(diff < -50) prevPage(); // کشیدن به چپ -> صفحه قبلی
});
</script>
</body>
</html>